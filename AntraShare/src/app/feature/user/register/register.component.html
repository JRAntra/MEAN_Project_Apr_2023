<div class="container">
  <p-card>
    <form [formGroup]="registerForm" class="form__container">
      <div class="field__container">
        <span class="p-float-label">
          <input pInputText formControlName="userName" id="username" />
          <label htmlFor="username">Username</label>
        </span>
        <ng-container
          *ngIf="
            registerForm.controls.userName.touched ||
            registerForm.controls.userName.dirty
          "
        >
          <div
            *ngIf="registerForm.controls.userName.valid; else usernameInvalid"
          >
            ✅
          </div>
        </ng-container>
        <ng-template #usernameInvalid>
          <i
            *ngIf="registerForm.controls.userName.pending"
            class="pi pi-spin pi-spinner"
          ></i>
          <div *ngIf="registerForm.controls.userName.errors?.['required']">
            ❗ this field is required
          </div>
          <div *ngIf="registerForm.controls.userName.errors?.['minlength']">
            ❗ username must be at least 3 characters
          </div>
          <div *ngIf="registerForm.controls.userName.errors?.['usernameExist']">
            ❗ this username is already taken
          </div>
        </ng-template>
      </div>

      <div class="field__container">
        <span class="p-float-label">
          <input pInputText id="email" formControlName="userEmail" />
          <label htmlFor="email">Email</label>
        </span>
        <ng-container
          *ngIf="
            registerForm.controls.userEmail.touched ||
            registerForm.controls.userEmail.dirty
          "
        >
          <div *ngIf="registerForm.controls.userEmail.valid; else emailInvalid">
            ✅
          </div>
        </ng-container>
        <ng-template #emailInvalid>
          <i
            *ngIf="registerForm.controls.userEmail.pending"
            class="pi pi-spin pi-spinner"
          ></i>
          <div *ngIf="registerForm.controls.userEmail.errors?.['required']">
            ❗ this field is required
          </div>
          <div *ngIf="registerForm.controls.userEmail.errors?.['email']">
            ❗ invalid email
          </div>
          <div *ngIf="registerForm.controls.userEmail.errors?.['emailExist']">
            ❗ this email is already registered
          </div>
        </ng-template>
      </div>

      <div class="field__container">
        <span class="p-float-label">
          <input
            pInputText
            type="password"
            id="password"
            formControlName="password"
          />
          <label for="password">Password</label>
        </span>
        <ng-container
          *ngIf="
            registerForm.controls.password.touched ||
            registerForm.controls.password.dirty
          "
        >
          <div
            *ngIf="registerForm.controls.password.valid; else passwordInvalid"
          >
            ✅
          </div>
        </ng-container>
        <ng-template #passwordInvalid>
          <div *ngIf="registerForm.controls.password.errors?.['required']">
            ❗ this field is required
          </div>
          <div
            *ngIf="registerForm.controls.password.errors?.['invalidCharacter']"
          >
            ❗ some characters are not allowed
          </div>
          <div
            *ngIf="registerForm.controls.password.errors?.['missingCharacter'].length > 0"
          >
            ❗ password must contain at least 1
            <ng-container
              *ngFor="let v of registerForm.controls.password.errors?.['missingCharacter'] ; let isLast=last"
              >{{ v }}{{ isLast ? "" : ", " }}</ng-container
            >
          </div>
          <div *ngIf="registerForm.controls.password.errors?.['minlength']">
            ❗ password must be at least 6 characters
          </div>
        </ng-template>
      </div>

      <div class="field__container">
        <span class="p-float-label confirmPassword__wrapper">
          <input
            pInputText
            type="password"
            id="confirmPassword"
            formControlName="confirmPassword"
          />

          <label for="password">Confirm Password</label>
        </span>
        <ng-container
          *ngIf="
            registerForm.controls.confirmPassword.touched ||
            registerForm.controls.confirmPassword.dirty
          "
        >
          <div
            *ngIf="
              registerForm.controls.confirmPassword.valid;
              else confirmPasswordInvalid
            "
          >
            ✅
          </div>
        </ng-container>
        <ng-template #confirmPasswordInvalid>
          <div
            *ngIf="
              registerForm.controls.confirmPassword.errors?.['required']
            "
          >
            ❗ this field is required
          </div>
          <div
            *ngIf="
              registerForm.errors?.['confirmPasswordNotMatch']
            "
          >
            ❗ password does not match
          </div>
        </ng-template>
      </div>

      <p-button
        label="Submit"
        [loading]="submitButtonLoading"
        (click)="onSubmitClicked()"
      ></p-button>
    </form>
  </p-card>
</div>
